#+TITLE:disentangle 
#+AUTHOR: Ivan Hanigan
#+email: ivan.hanigan@anu.edu.au
#+LaTeX_CLASS: article
#+LaTeX_CLASS_OPTIONS: [a4paper]
#+LATEX: \tableofcontents
-----

** oldnode2orgmode
*** test-oldnode2orgmode
#+name:oldnode2orgmode
#+begin_src R :session *R* :tangle tests/test-oldnode2orgmode.r :exports none :eval no
  ################################################################
  # name:oldnode2orgmode
          project = unlist(strsplit(getwd(),"/"))[length(unlist(strsplit(getwd(),"/")))]
          title = NA
          dsc=''
          ttype=dsc
          i=NA
          o=NA
          notes=''
          code=NA
          TASK=NA
          subsection=T
          nosectionheading=F
          dontshow=NA
          append=T
          document='sweave'
          insertgraph=NA
          doc_code=T
          end_doc=F
          dontshow_doc=NA
          evalCode='FALSE'
          echoCode='TRUE'
          inserttable=NA
          caption=''
          tablabel='tabx'
          digits=''
          align=''
          tabsideways=F
          clearpage=F
          KEYNODE=NA
  
  #oldnode2orgmode(
  dsc = 'Introduction'
  ,
  ttype = 'reports'
  ,
  title = 'HF data prep'
  ,
   dontshow = T
  ,
   notes = '
   This is the workflow diagram for the health forecasting project at NCEPH \\cite{Dear2010} which can be viewed
   \\href{http://dl.dropbox.com/u/7075452/HF_data/data_transformations.html}{at this link}.
  
   The relationship between daily air quality and daily hospital admissions is being examined:
   \\begin{itemize}
   \\item Three cities, Brisbane, Melbourne and Sydney
   \\item Daily for seven years, 1998 - 2004 (2,557 days)
   \\item Twelve disease clusters; both emergency admissions and all admissions; though for most analyses only emergency admissions were considered
   \\item By age and sex  (twelve groups)
   \\item By spatial subunits of each city: statistical local area (SLA) for Melbourne and Sydney and, for Brisbane, larger zones (clusters of SLAs) designed specifically for this project.
   \\end{itemize}
   In all there were 0.76 million emergency admissions in Brisbane, 1.66m in Melbourne, and 2.54m in Sydney.
   '
  ,
   append = F
  ,
   code = NA
  )
  
#+end_src
*** R-oldnode2orgmode
#+name:oldnode2orgmode
#+begin_src R :session *R* :tangle R/oldnode2orgmode.r :exports none :eval no
  ################################################################
  # name:oldnode2orgmode
  #maybe args dsc, ttype, title, dontshow, notes, append, code)
  oldnode2orgmode <- function(project = unlist(strsplit(getwd(),"/"))[length(unlist(strsplit(getwd(),"/")))],
          title = NA,
          dsc='',ttype=dsc,
          i=NA,
          o=NA,
          notes='',
          code=NA,
          TASK=NA,subsection=T,nosectionheading=F,
          dontshow=NA,append=T, document='sweave',insertgraph=NA,
          doc_code=T, end_doc=F,dontshow_doc=NA,evalCode='FALSE',echoCode='TRUE',inserttable=NA,caption='',
          tablabel='tabx',digits='',align='', tabsideways=F, clearpage=F,
          KEYNODE=NA)
  {
  if(is.na(ttype)) ttype <- dsc
  if(is.na(i[1]))
  {
    i <- paste(dsc,1,sep = '-')
  } else {
    i <- paste(i,sep="", collapse="','")
  }
  if(is.na(o[1]))
  {
    o <- 'NA'
  } else {
    o <- paste(o,sep="", collapse="','")
  }
  
  
  node <- paste("
  ,** ",ttype,"-",dsc,"\n",
  notes,"\n
  ,*** newnode-",dsc,"\n
  \\#+name:dsc
  \\#+begin_src R :session *R* :tangle transformations_overview.r :exports none :eval no
  nodes <- newnode(name='",dsc,"',
   inputs = c('",i ,"'),
   outputs = c('",o,"')
   )
  \\#+end_src
  ", sep = "")
  
  
  cat(print(node))
  ##################################
  sink(paste(project,'overview-TEST.org', sep = "-"))
  cat(node)
  sink()
  
  
  }
  
#+end_src
*** man-oldnode2orgmode
#+name:oldnode2orgmode
#+begin_src R :session *R* :tangle no :exports none :eval no
################################################################
# name:oldnode2orgmode

#+end_src
